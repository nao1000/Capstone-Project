{% extends 'core/base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/base.css' %}">
<style>
    /* Keep only what is unique to the dashboard */
    .action-bar { display: flex; gap: 20px; margin-bottom: 30px; flex-wrap: wrap; }
    .action-bar .card { flex: 1; min-width: 300px; } 

    .section-title { border-bottom: 2px solid #ddd; padding-bottom: 10px; margin-bottom: 20px; margin-top: 40px; color: #444; }
    .team-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }

    .team-card { background: white; border: 1px solid #e1e4e8; border-radius: 8px; padding: 20px; transition: transform 0.2s; position: relative; }
    .team-card:hover { transform: translateY(-3px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }

    .team-name { font-size: 1.2rem; font-weight: bold; margin: 0 0 5px 0; }
    .team-code { font-size: 0.85rem; color: #666; background: #f8f9fa; padding: 4px 8px; border-radius: 4px; display: inline-block; margin-bottom: 15px; border: 1px dashed #ccc; }

    .open-btn { display: block; text-align: center; background: #f1f3f5; color: #333; padding: 10px; text-decoration: none; border-radius: 4px; font-weight: 600; margin-top: 10px; }
    .open-btn:hover { background: #e9ecef; }
</style>
{% endblock %}

{% block content %}
<div class="container dashboard">
    <h2 class="section-title">Teams You Supervise</h2>
    <div class="team-grid">
        {% for team in owned_teams %}
        <div class="team-card">
            <span class="role-badge badge-owner">Supervisor</span>
            <h3 class="team-name">{{ team.name }}</h3>
            <div class="team-code">Join Code: <strong>{{ team.join_code }}</strong></div>
            <p style="font-size: 13px; color: #666; margin: 0 0 15px 0;">
                Members: {{ team.members.count }}
            </p>
            <a href="{% url 'supervisor' team.id %}" class="open-btn supervisor">Manage Schedule →</a>
        </div>
        {% empty %}
        <p class="empty-state">You haven't created any teams yet.</p>
        {% endfor %}
    </div>

    <h2 class="section-title">Teams You Joined</h2>
    <div class="team-grid">
        {% for team in joined_teams %}
        <div class="team-card">
            <span class="role-badge badge-member">Worker</span>
            <h3 class="team-name">{{ team.name }}</h3>
            <p style="font-size: 13px; color: #666;">Supervisor: {{ team.owner.username }}</p>
            <a href="{% url 'availability' team.id %}" class="open-btn">Update Availability →</a>
        </div>
        {% empty %}
        <p class="empty-state">You haven't joined any teams yet.</p>
        {% endfor %}
    </div>
    <div class="action-bar">
        <div class="card">
            <h3>Join a Team</h3>
            <form action="{% url 'join_team' %}" method="POST">
                {% csrf_token %}
                <input type="text" name="join_code" placeholder="Enter Join Code" required>
                <button type="submit" class="btn-secondary">Join Team</button>
            </form>
        </div>

        <div class="card">
            <h3>Create New Team</h3>
            <form action="{% url 'create_team' %}" method="POST">
                {% csrf_token %}
                <input type="text" name="team_name" placeholder="Team Name" required>
                <button type="submit" class="btn-primary">Create & Supervise</button>
            </form>
        </div>
    </div>

</div>
{% endblock %}